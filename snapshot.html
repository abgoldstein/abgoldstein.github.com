<html>
  <head>
    <title>Snapshot demo</title>
    <script type="text/javascript" src="http://code.jquery.com/jquery-latest.pack.js"></script>
    <script type="text/javascript">
      var video;
			var canvas;
      var context;
      var localMediaStream;
      
      $(document).ready(function() {
        video = $("#video")[0];
				canvas = $("#canvas")[0];
        context = canvas.getContext('2d');
        
        video.addEventListener('click', snapshot, false);
        navigator.getUserMedia({video: true}, function(stream) {
          video.src = window.URL.createObjectURL(stream);
          localMediaStream = stream;
        }, null);
      });

			function hurray() {
				alert("Wooopie!");
			}

      function snapshot() {
        context.drawImage(video, 0, 0);
				var imgData = canvas.toDataURL("image/png");
				
				$.post("http://localhost:3000/products/4fc2a2f060de7d41b0000004/blah", {
          img : canvas.toDataURL('image/jpeg')
				}, function(data) {
					alert('success!');
				}, "json");
      }
    </script>
  </head>
  <body>
    <video id="video" width="600" height="400" autoplay></video>
    <canvas id="canvas" width="600" height="400"></canvas>
  </body>
</html>