<html>
  <head>
    <title>Snapshot demo</title>
    <script type="text/javascript" src="http://code.jquery.com/jquery-latest.pack.js"></script>
    <script type="text/javascript">
      var video;
      var canvas;
      var context;
      var localMediaStream;
      
      $(document).ready(function() {
        video = $("#video")[0];
        canvas = $("#canvas")[0];
        context = canvas.getContext('2d');
        
        video.addEventListener('click', snapshot, false);
        navigator.getUserMedia({video: true}, function(stream) {
          video.src = window.URL.createObjectURL(stream);
          localMediaStream = stream;
        }, null);
      });

      function snapshot() {
        if (localMediaStream) {
          context.drawImage(video, 0, 0);
          $("#snapshot").src = canvas.toDataURL('image/webp');
        }
      }
    </script>
  </head>
  <body>
    <video id="video" autoplay></video>
    <img id="snapshot" src="" style="display: none;"></img>
    <canvas id="canvas"></canvas>
  </body>
</html>